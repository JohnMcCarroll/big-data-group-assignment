tab2 <- read.xlsx("data//table-2-1.xlsx", 1, header = TRUE)
tab2 <- tab2[(-1:-4),]
cols2 <- tab2[1,]
cols2[1] = "Group"
colnames(tab2) <- cols2
tab2 <- tab2[-1,]
tab2rem <- cleanvals(tab2)
tab2 <- tab2[-tab2rem,]
#load table 2
tab3 <- read.xlsx("data//table-3.xlsx", 1, header = TRUE)
tab3 <- tab3[(-1:-2),]
cols3 <- tab3[1,]
for(x in 1:length(cols3)) {
if(is.na(cols3[x])) {
cols3[x] <- paste(cols3[x-1], '(%)')
}
}
colnames(tab3) <- cols3
tab3 <- tab3[-1:-2,]
tab3[1,1] <- "\t Total"
tab3rem <- cleanvals(tab3)
tab3 <- tab3[-tab3rem,]
tab3[tab3 =='Z'] <- 0
#load table 2
tab1 <- read.xlsx("data//table-1-1.xlsx", 1, header = TRUE)
tab1 <- tab1[(-1:-4),]
cols1 <- tab1[1,]
cols1[1] = "Group"
colnames(tab1) <- cols1
tab1 <- tab1[-1,]
tab1rem <- cleanvals(tab1)
tab1 <- tab1[-tab1rem,]
#load table 2
tab2 <- read.xlsx("data//table-2-1.xlsx", 1, header = TRUE)
tab2 <- tab2[(-1:-4),]
cols2 <- tab2[1,]
cols2[1] = "Group"
colnames(tab2) <- cols2
tab2 <- tab2[-1,]
tab2rem <- cleanvals(tab2)
tab2 <- tab2[-tab2rem,]
#load table 2
tab3 <- read.xlsx("data//table-3.xlsx", 1, header = TRUE)
tab3 <- tab3[(-1:-2),]
cols3 <- tab3[1,]
for(x in 1:length(cols3)) {
if(is.na(cols3[x])) {
cols3[x] <- paste(cols3[x-1], '(%)')
}
}
colnames(tab3) <- cols3
tab3 <- tab3[-1:-2,]
tab3[1,1] <- "\t Total"
tab3rem <- cleanvals(tab3)
tab3 <- tab3[-tab3rem,]
tab3[tab3 =='Z'] <- 0
View(tab2)
#load table 2
tab1 <- read.xlsx("data//table-1-1.xlsx", 1, header = TRUE)
tab1 <- tab1[(-1:-4),]
cols1 <- tab1[1,]
cols1[1] = "Group"
colnames(tab1) <- cols1
tab1 <- tab1[-1,]
tab1rem <- cleanvals(tab1)
tab1 <- tab1[-tab1rem,]
tab1 <- tab1[-31,]
#load table 2
tab2 <- read.xlsx("data//table-2-1.xlsx", 1, header = TRUE)
tab2 <- tab2[(-1:-4),]
cols2 <- tab2[1,]
cols2[1] = "Group"
colnames(tab2) <- cols2
tab2 <- tab2[-1,]
tab2rem <- cleanvals(tab2)
tab2 <- tab2[-tab2rem,]
#load table 2
tab3 <- read.xlsx("data//table-3.xlsx", 1, header = TRUE)
tab3 <- tab3[(-1:-2),]
cols3 <- tab3[1,]
for(x in 1:length(cols3)) {
if(is.na(cols3[x])) {
cols3[x] <- paste(cols3[x-1], '(%)')
}
}
colnames(tab3) <- cols3
tab3 <- tab3[-1:-2,]
tab3[1,1] <- "\t Total"
tab3rem <- cleanvals(tab3)
tab3 <- tab3[-tab3rem,]
tab3[tab3 =='Z'] <- 0
#load table 2
tab1 <- read.xlsx("data//table-1-1.xlsx", 1, header = TRUE)
tab1 <- tab1[(-1:-4),]
cols1 <- tab1[1,]
cols1[1] = "Group"
colnames(tab1) <- cols1
tab1 <- tab1[-1,]
tab1rem <- cleanvals(tab1)
tab1 <- tab1[-tab1rem,]
tab1 <- tab1[-9,]
#load table 2
tab2 <- read.xlsx("data//table-2-1.xlsx", 1, header = TRUE)
tab2 <- tab2[(-1:-4),]
cols2 <- tab2[1,]
cols2[1] = "Group"
colnames(tab2) <- cols2
tab2 <- tab2[-1,]
tab2rem <- cleanvals(tab2)
tab2 <- tab2[-tab2rem,]
#load table 2
tab3 <- read.xlsx("data//table-3.xlsx", 1, header = TRUE)
tab3 <- tab3[(-1:-2),]
cols3 <- tab3[1,]
for(x in 1:length(cols3)) {
if(is.na(cols3[x])) {
cols3[x] <- paste(cols3[x-1], '(%)')
}
}
colnames(tab3) <- cols3
tab3 <- tab3[-1:-2,]
tab3[1,1] <- "\t Total"
tab3rem <- cleanvals(tab3)
tab3 <- tab3[-tab3rem,]
tab3[tab3 =='Z'] <- 0
#load table 2
tab1 <- read.xlsx("data//table-1-1.xlsx", 1, header = TRUE)
tab1 <- tab1[(-1:-4),]
cols1 <- tab1[1,]
cols1[1] = "Group"
colnames(tab1) <- cols1
tab1 <- tab1[-1,]
tab1rem <- cleanvals(tab1)
tab1 <- tab1[-tab1rem,]
#load table 2
tab2 <- read.xlsx("data//table-2-1.xlsx", 1, header = TRUE)
tab2 <- tab2[(-1:-4),]
cols2 <- tab2[1,]
cols2[1] = "Group"
colnames(tab2) <- cols2
tab2 <- tab2[-1,]
tab2rem <- cleanvals(tab2)
tab2 <- tab2[-tab2rem,]
tab2 <- tab2[-26,]
#load table 2
tab3 <- read.xlsx("data//table-3.xlsx", 1, header = TRUE)
tab3 <- tab3[(-1:-2),]
cols3 <- tab3[1,]
for(x in 1:length(cols3)) {
if(is.na(cols3[x])) {
cols3[x] <- paste(cols3[x-1], '(%)')
}
}
colnames(tab3) <- cols3
tab3 <- tab3[-1:-2,]
tab3[1,1] <- "\t Total"
tab3rem <- cleanvals(tab3)
tab3 <- tab3[-tab3rem,]
tab3[tab3 =='Z'] <- 0
View(tab2)
#load table 2
tab1 <- read.xlsx("data//table-1-1.xlsx", 1, header = TRUE)
tab1 <- tab1[(-1:-4),]
cols1 <- tab1[1,]
cols1[1] = "Group"
colnames(tab1) <- cols1
tab1 <- tab1[-1,]
tab1rem <- cleanvals(tab1)
tab1 <- tab1[-tab1rem,]
#load table 2
tab2 <- read.xlsx("data//table-2-1.xlsx", 1, header = TRUE)
tab2 <- tab2[(-1:-4),]
cols2 <- tab2[1,]
cols2[1] = "Group"
colnames(tab2) <- cols2
tab2 <- tab2[-1,]
tab2rem <- cleanvals(tab2)
tab2 <- tab2[-tab2rem,]
tab2 <- tab2[-25,]
#load table 2
tab3 <- read.xlsx("data//table-3.xlsx", 1, header = TRUE)
tab3 <- tab3[(-1:-2),]
cols3 <- tab3[1,]
for(x in 1:length(cols3)) {
if(is.na(cols3[x])) {
cols3[x] <- paste(cols3[x-1], '(%)')
}
}
colnames(tab3) <- cols3
tab3 <- tab3[-1:-2,]
tab3[1,1] <- "\t Total"
tab3rem <- cleanvals(tab3)
tab3 <- tab3[-tab3rem,]
tab3[tab3 =='Z'] <- 0
View(tab2)
#load table 2
tab1 <- read.xlsx("data//table-1-1.xlsx", 1, header = TRUE)
tab1 <- tab1[(-1:-4),]
cols1 <- tab1[1,]
cols1[1] = "Group"
colnames(tab1) <- cols1
tab1 <- tab1[-1,]
tab1rem <- cleanvals(tab1)
tab1 <- tab1[-tab1rem,]
#load table 2
tab2 <- read.xlsx("data//table-2-1.xlsx", 1, header = TRUE)
tab2 <- tab2[(-1:-4),]
cols2 <- tab2[1,]
cols2[1] = "Group"
colnames(tab2) <- cols2
tab2 <- tab2[-1,]
tab2rem <- cleanvals(tab2)
tab2 <- tab2[-tab2rem,]
tab2 <- tab2[-31,]
#load table 2
tab3 <- read.xlsx("data//table-3.xlsx", 1, header = TRUE)
tab3 <- tab3[(-1:-2),]
cols3 <- tab3[1,]
for(x in 1:length(cols3)) {
if(is.na(cols3[x])) {
cols3[x] <- paste(cols3[x-1], '(%)')
}
}
colnames(tab3) <- cols3
tab3 <- tab3[-1:-2,]
tab3[1,1] <- "\t Total"
tab3rem <- cleanvals(tab3)
tab3 <- tab3[-tab3rem,]
tab3[tab3 =='Z'] <- 0
View(tab2)
#load table 2
tab1 <- read.xlsx("data//table-1-1.xlsx", 1, header = TRUE)
tab1 <- tab1[(-1:-4),]
cols1 <- tab1[1,]
cols1[1] = "Group"
colnames(tab1) <- cols1
tab1 <- tab1[-1,]
tab1rem <- cleanvals(tab1)
tab1 <- tab1[-tab1rem,]
#load table 2
tab2 <- read.xlsx("data//table-2-1.xlsx", 1, header = TRUE)
tab2 <- tab2[(-1:-4),]
cols2 <- tab2[1,]
cols2[1] = "Group"
colnames(tab2) <- cols2
tab2 <- tab2[-1,]
tab2rem <- cleanvals(tab2)
tab2 <- tab2[-tab2rem,]
tab2 <- tab2[-39,]
#load table 2
tab3 <- read.xlsx("data//table-3.xlsx", 1, header = TRUE)
tab3 <- tab3[(-1:-2),]
cols3 <- tab3[1,]
for(x in 1:length(cols3)) {
if(is.na(cols3[x])) {
cols3[x] <- paste(cols3[x-1], '(%)')
}
}
colnames(tab3) <- cols3
tab3 <- tab3[-1:-2,]
tab3[1,1] <- "\t Total"
tab3rem <- cleanvals(tab3)
tab3 <- tab3[-tab3rem,]
tab3[tab3 =='Z'] <- 0
View(tab2)
#load table 2
tab1 <- read.xlsx("data//table-1-1.xlsx", 1, header = TRUE)
tab1 <- tab1[(-1:-4),]
cols1 <- tab1[1,]
cols1[1] = "Group"
colnames(tab1) <- cols1
tab1 <- tab1[-1,]
tab1rem <- cleanvals(tab1)
tab1 <- tab1[-tab1rem,]
#load table 2
tab2 <- read.xlsx("data//table-2-1.xlsx", 1, header = TRUE)
tab2 <- tab2[(-1:-4),]
cols2 <- tab2[1,]
cols2[1] = "Group"
colnames(tab2) <- cols2
tab2 <- tab2[-1,]
tab2rem <- cleanvals(tab2)
tab2 <- tab2[-tab2rem,]
#load table 2
tab3 <- read.xlsx("data//table-3.xlsx", 1, header = TRUE)
tab3 <- tab3[(-1:-2),]
cols3 <- tab3[1,]
for(x in 1:length(cols3)) {
if(is.na(cols3[x])) {
cols3[x] <- paste(cols3[x-1], '(%)')
}
}
colnames(tab3) <- cols3
tab3 <- tab3[-1:-2,]
tab3[1,1] <- "\t Total"
tab3rem <- cleanvals(tab3)
tab3 <- tab3[-tab3rem,]
tab3[tab3 =='Z'] <- 0
View(tab2)
#load table 2
tab1 <- read.xlsx("data//table-1-1.xlsx", 1, header = TRUE)
tab1 <- tab1[(-1:-4),]
cols1 <- tab1[1,]
cols1[1] = "Group"
colnames(tab1) <- cols1
tab1 <- tab1[-1,]
tab1rem <- cleanvals(tab1)
tab1 <- tab1[-tab1rem,]
#load table 2
tab2 <- read.xlsx("data//table-2-1.xlsx", 1, header = TRUE)
tab2 <- tab2[(-1:-4),]
cols2 <- tab2[1,]
cols2[1] = "Group"
colnames(tab2) <- cols2
tab2 <- tab2[-1,]
tab2rem <- cleanvals(tab2)
tab2 <- tab2[-tab2rem,]
tab2 <- tab2[-32,]
#load table 2
tab3 <- read.xlsx("data//table-3.xlsx", 1, header = TRUE)
tab3 <- tab3[(-1:-2),]
cols3 <- tab3[1,]
for(x in 1:length(cols3)) {
if(is.na(cols3[x])) {
cols3[x] <- paste(cols3[x-1], '(%)')
}
}
colnames(tab3) <- cols3
tab3 <- tab3[-1:-2,]
tab3[1,1] <- "\t Total"
tab3rem <- cleanvals(tab3)
tab3 <- tab3[-tab3rem,]
tab3[tab3 =='Z'] <- 0
View(tab2)
#load table 2
tab1 <- read.xlsx("data//table-1-1.xlsx", 1, header = TRUE)
tab1 <- tab1[(-1:-4),]
cols1 <- tab1[1,]
cols1[1] = "Group"
colnames(tab1) <- cols1
tab1 <- tab1[-1,]
tab1rem <- cleanvals(tab1)
tab1 <- tab1[-tab1rem,]
#load table 2
tab2 <- read.xlsx("data//table-2-1.xlsx", 1, header = TRUE)
tab2 <- tab2[(-1:-4),]
cols2 <- tab2[1,]
cols2[1] = "Group"
colnames(tab2) <- cols2
tab2 <- tab2[-1,]
tab2rem <- cleanvals(tab2)
tab2 <- tab2[-tab2rem,]
tab2 <- na.omit(tab2)
#load table 2
tab3 <- read.xlsx("data//table-3.xlsx", 1, header = TRUE)
tab3 <- tab3[(-1:-2),]
cols3 <- tab3[1,]
for(x in 1:length(cols3)) {
if(is.na(cols3[x])) {
cols3[x] <- paste(cols3[x-1], '(%)')
}
}
colnames(tab3) <- cols3
tab3 <- tab3[-1:-2,]
tab3[1,1] <- "\t Total"
tab3rem <- cleanvals(tab3)
tab3 <- tab3[-tab3rem,]
tab3[tab3 =='Z'] <- 0
View(tab2)
db_name <- 'educational_attainment_database.db'
mydb <- dbConnect(RSQLite::SQLite(), db_name)
lfDat <- dbGetQuery(mydb, 'SELECT * FROM TABLE_2')
dbDisconnect(mydb)
str(lfDat)
colnames(lfDat) <- c('Characteristics', 'Total', 'None', '11th', 'HSGrad', 'SomeCollege', 'Associates', 'Bachelors', 'Masters', 'Professional', 'Doctoral')
grps <- lfDat[,1]
lfDat <- lfDat[,-1]
lfDat <- mutate_all(lfDat, function(x) as.numeric(as.character(x)))
lfDat <- cbind(grps, lfDat)
lfDat$noHS <- rowSums(lfDat[,3:4])
lfDat$HS <- rowSums(lfDat[,5:6])
lfDat <- lfDat[30:32,]
n <- colnames(lfDat)[-1]
lfTrans <- transpose(lfDat[,-1])
rownames(lfTrans) <- n
cn <- c('Employed', 'Unemployed', 'NonCivLForce')
colnames(lfTrans) <- cn
lfTrans$total <- rowSums(lfTrans)
lfClean <- data.frame()
for(x in 1:length(lfTrans[,1])) {
for(y in 1:3) {
nrow <- c(n[x], cn[y], lfTrans[x,y], lfTrans[x,4])
lfClean <- rbind(lfClean, nrow)
}
}
lfClean <- lfClean[-1:-15,]
temp <- lfClean[16:21,]
lfClean <- lfClean[-16:-21,]
lfClean <- rbind(temp, lfClean)
colnames(lfClean) <- c('EdAttain', 'LFStatus', 'Count', 'Total')
lfClean <- transform(lfClean, Count = as.numeric(Count))
lfClean <- transform(lfClean, Total = as.numeric(Total))
str(lfClean)
lfClean <- transform(lfClean, Percent = Count / Total * 100)
lfClean
library(dplyr)
library(DBI)
library(RSQLite)
library(xlsx)
cleanvals <- function(tab) {
rem <- vector(mode='list', length=length(tab[,1]))
for(x in (1:length(tab[,1]))) {
if(substring(tab[x,1], 1, 1) != '\t') {
rem[[x]] <- x
}
}
return(unlist(rem))
}
#load table 2
tab1 <- read.xlsx("data//table-1-1.xlsx", 1, header = TRUE)
tab1 <- tab1[(-1:-4),]
cols1 <- tab1[1,]
cols1[1] = "Group"
colnames(tab1) <- cols1
tab1 <- tab1[-1,]
tab1rem <- cleanvals(tab1)
tab1 <- tab1[-tab1rem,]
#load table 2
tab2 <- read.xlsx("data//table-2-1.xlsx", 1, header = TRUE)
tab2 <- tab2[(-1:-4),]
cols2 <- tab2[1,]
cols2[1] = "Group"
colnames(tab2) <- cols2
tab2 <- tab2[-1,]
tab2rem <- cleanvals(tab2)
tab2 <- tab2[-tab2rem,]
tab2 <- na.omit(tab2)
#load table 2
tab3 <- read.xlsx("data//table-3.xlsx", 1, header = TRUE)
tab3 <- tab3[(-1:-2),]
cols3 <- tab3[1,]
for(x in 1:length(cols3)) {
if(is.na(cols3[x])) {
cols3[x] <- paste(cols3[x-1], '(%)')
}
}
colnames(tab3) <- cols3
tab3 <- tab3[-1:-2,]
tab3[1,1] <- "\t Total"
tab3rem <- cleanvals(tab3)
tab3 <- tab3[-tab3rem,]
tab3[tab3 =='Z'] <- 0
db_name <- 'educational_attainment_database.db'
mydb <- dbConnect(RSQLite::SQLite(), db_name)
dbWriteTable(mydb, "table_1", tab1)
dbWriteTable(mydb, "table_2", tab2)
dbWriteTable(mydb, "table_3", tab3)
dbListTables(mydb)
dbGetQuery(mydb, 'SELECT * FROM TABLE_1')
dbGetQuery(mydb, 'SELECT * FROM TABLE_2')
dbGetQuery(mydb, 'SELECT * FROM TABLE_3')
dbDisconnect(mydb)
library(dplyr)
library(ggplot2)
library(xlsx)
library(data.table)
library(DBI)
library(RSQLite)
db_name <- 'educational_attainment_database.db'
mydb <- dbConnect(RSQLite::SQLite(), db_name)
lfDat <- dbGetQuery(mydb, 'SELECT * FROM TABLE_2')
dbDisconnect(mydb)
str(lfDat)
colnames(lfDat) <- c('Characteristics', 'Total', 'None', '11th', 'HSGrad', 'SomeCollege', 'Associates', 'Bachelors', 'Masters', 'Professional', 'Doctoral')
grps <- lfDat[,1]
lfDat <- lfDat[,-1]
lfDat <- mutate_all(lfDat, function(x) as.numeric(as.character(x)))
lfDat <- cbind(grps, lfDat)
lfDat$noHS <- rowSums(lfDat[,3:4])
lfDat$HS <- rowSums(lfDat[,5:6])
lfDat <- lfDat[30:32,]
n <- colnames(lfDat)[-1]
lfTrans <- transpose(lfDat[,-1])
rownames(lfTrans) <- n
cn <- c('Employed', 'Unemployed', 'NonCivLForce')
colnames(lfTrans) <- cn
lfTrans$total <- rowSums(lfTrans)
lfClean <- data.frame()
for(x in 1:length(lfTrans[,1])) {
for(y in 1:3) {
nrow <- c(n[x], cn[y], lfTrans[x,y], lfTrans[x,4])
lfClean <- rbind(lfClean, nrow)
}
}
lfClean <- lfClean[-1:-15,]
temp <- lfClean[16:21,]
lfClean <- lfClean[-16:-21,]
lfClean <- rbind(temp, lfClean)
colnames(lfClean) <- c('EdAttain', 'LFStatus', 'Count', 'Total')
lfClean <- transform(lfClean, Count = as.numeric(Count))
lfClean <- transform(lfClean, Total = as.numeric(Total))
str(lfClean)
lfClean <- transform(lfClean, Percent = Count / Total * 100)
lfClean
lfClean$EdAttain <= factor(lfClean$EdAttain, levels = c('noHS', "HS", 'Associates', 'Bachelors', 'Masters', 'Professional', 'Doctoral'), ordered = TRUE)
lfPlot <- ggplot(lfClean, aes(fill = LFStatus, y = Percent, x = EdAttain)) +
geom_bar(position = "dodge", stat = "identity") +
scale_x_discrete(limits=c('noHS', "HS", 'Associates', 'Bachelors', 'Masters', 'Professional', 'Doctoral')) +
xlab("Educational Attainment") +
ylab("Percent in Labor Force") +
scale_discrete_manual(aesthetics = c("colour", "fill"), values = c('#5ba300', '#e6308a', '#0073e6' ), labels = c('Employed', 'Not in civilian labor force', 'Unemployed'), name = 'Labor Force Status')
lfPlot
